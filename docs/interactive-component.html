<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Interactive component | Energy and Human Development</title>
  <meta name="description" content="Chapter 6 Interactive component | Energy and Human Development" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Interactive component | Energy and Human Development" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Interactive component | Energy and Human Development" />
  
  
  

<meta name="author" content="Antonin Vidon and Jannik Wiedenhaupt" />


<meta name="date" content="2021-12-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="results.html"/>
<link rel="next" href="conclusion.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Energy and Human Development</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>2</b> Data sources</a></li>
<li class="chapter" data-level="3" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>3</b> Data transformation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-transformation.html"><a href="data-transformation.html#selecting-the-time-range"><i class="fa fa-check"></i><b>3.1</b> Selecting the time range</a></li>
<li class="chapter" data-level="3.2" data-path="data-transformation.html"><a href="data-transformation.html#selecting-the-variables"><i class="fa fa-check"></i><b>3.2</b> Selecting the variables</a></li>
<li class="chapter" data-level="3.3" data-path="data-transformation.html"><a href="data-transformation.html#data-transformation-procedure"><i class="fa fa-check"></i><b>3.3</b> Data transformation procedure</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="missing-values.html"><a href="missing-values.html"><i class="fa fa-check"></i><b>4</b> Missing values</a>
<ul>
<li class="chapter" data-level="4.1" data-path="missing-values.html"><a href="missing-values.html#missing-values-for-the-merged-dataframe"><i class="fa fa-check"></i><b>4.1</b> Missing values for the merged dataframe</a></li>
<li class="chapter" data-level="4.2" data-path="missing-values.html"><a href="missing-values.html#dive-into-each-primar-dataset-understanding-the-missing-values"><i class="fa fa-check"></i><b>4.2</b> Dive into each primar dataset : understanding the missing values</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="results.html"><a href="results.html"><i class="fa fa-check"></i><b>5</b> Results</a>
<ul>
<li class="chapter" data-level="5.1" data-path="results.html"><a href="results.html#cross-directional-causality-between-energy-consumption-ec-gdp-and-years-of-schooling-yos"><i class="fa fa-check"></i><b>5.1</b> Cross directional causality between energy consumption (EC), GDP and years of schooling (YOS)</a></li>
<li class="chapter" data-level="5.2" data-path="results.html"><a href="results.html#co-movement-of-energy-consumption-and-hdi"><i class="fa fa-check"></i><b>5.2</b> Co-movement of energy consumption and HDI</a></li>
<li class="chapter" data-level="5.3" data-path="results.html"><a href="results.html#association-of-human-development-and-renewable-energy"><i class="fa fa-check"></i><b>5.3</b> Association of human development and renewable energy</a></li>
<li class="chapter" data-level="5.4" data-path="results.html"><a href="results.html#characteristics-of-countries-with-a-high-share-of-renewable-energy"><i class="fa fa-check"></i><b>5.4</b> Characteristics of countries with a high share of renewable energy</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="interactive-component.html"><a href="interactive-component.html"><i class="fa fa-check"></i><b>6</b> Interactive component</a></li>
<li class="chapter" data-level="7" data-path="conclusion.html"><a href="conclusion.html"><i class="fa fa-check"></i><b>7</b> Conclusion</a>
<ul>
<li class="chapter" data-level="7.1" data-path="conclusion.html"><a href="conclusion.html#answers"><i class="fa fa-check"></i><b>7.1</b> Answers</a></li>
<li class="chapter" data-level="7.2" data-path="conclusion.html"><a href="conclusion.html#limitations"><i class="fa fa-check"></i><b>7.2</b> Limitations</a></li>
<li class="chapter" data-level="7.3" data-path="conclusion.html"><a href="conclusion.html#future-directions"><i class="fa fa-check"></i><b>7.3</b> Future directions</a></li>
<li class="chapter" data-level="7.4" data-path="conclusion.html"><a href="conclusion.html#summary"><i class="fa fa-check"></i><b>7.4</b> Summary</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Energy and Human Development</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="interactive-component" class="section level1" number="6">
<h1><span class="header-section-number">Chapter 6</span> Interactive component</h1>
<div id="interactive-visualization-on-the-energy-mix-by-hdi-level" class="section level2 unlisted unnumbered">
<h2>Interactive visualization on the energy mix by HDI level</h2>
<p>The interactive plot offers the following features :</p>
<ul>
<li>Selecting only a part of the y-axis to identify the smaller categories;</li>
<li>Hovering over each element of the legend to highlight the variable in the graph;</li>
<li>Selecting countries of which HDI level you want to examine.</li>
</ul>
<style>
  body {
    font-family: Verdana, Arial, sans-serif;
  }

  h1 {
    font-size: 1.2em;
    margin: 60px 0 5px 0;
  }

  svg {
    width: 1200px;
    margin-left: auto;
    margin-right: auto;
  }

  b {
    margin-left: 50px;
  }

  .wrapper {
    width: 800px;
    margin-left: 100px;
  }

  .HDI_category {
    width: 50px;
    text-align: center;
  }
</style>
<!-- Load d3.js -->
<script src="https://d3js.org/d3.v7.js"></script>
<!-- Create a div where the graph will take place -->
<div id="my_dataviz">

</div>
<!-- Initialize a select button -->
<b>Select the wanted HDI category: </b>
<select id="HDI_category"></select>
</body>
<script>
  // set the dimensions and margins of the graph
  const margin = { top: 60, right: 230, bottom: 20, left: 50 },
    width = 800 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

  // append the svg object to the body of the page
  const svg = d3
    .select("#my_dataviz")
    .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", `translate(${margin.left}, ${margin.top})`);

  // Parse the Data
  d3.csv(
    "https://raw.githubusercontent.com/AntoninVidon/energyhumandevelopment/main/data/interactive7.csv"
  ).then(function (data) {
    // List of groups (here I have one group per column)
    const allGroup = ["Medium", "High", "Very high"];

    // add the options to the button
    d3.select("#HDI_category")
      .selectAll("myOptions")
      .data(allGroup)
      .enter()
      .append("option")
      .text(function (d) {
        return d;
      }) // text showed in the menu
      .attr("value", function (d) {
        return d;
      }); // corresponding value returned by the button

    // store old data
    old_data = data
    data = old_data.filter(function (d) {
      return d.HDI == "High";
    });

    //////////
    // GENERAL //
    //////////

    // List of groups = header of the csv files
    //const keys = data.columns.slice(1)
    const keys = [
      "Coal",
      "Oil",
      "Gas",
      "Hydropower",
      "Nuclear",
      "Solar",
      "Biofuel",
      "Wind",
      "Other_renewables",
    ];

    // color palette
    const color = d3
      .scaleOrdinal()
      .domain(keys)
      .range([
        "#645f55",
        "black",
        "#b18781",
        "#1e7991",
        "#c0b879",
        "#eabc35",
        "#8d9e2b",
        "#7cabcb",
        "#d0d890",
      ]);

    //stack the data?
    const stackedData = d3.stack().keys(keys)(data);

    //////////
    // AXIS //
    //////////

    // Add X axis
    const x = d3
      .scaleLinear()
      .domain(
        d3.extent(data, function (d) {
          return d.Year;
        })
      )
      .range([0, width]);
    const xAxis = svg
      .append("g")
      .attr("transform", `translate(0, ${height})`)
      .call(d3.axisBottom(x).ticks(5).tickFormat(d3.format("d")));

    // Add X axis label:
    svg
      .append("text")
      .attr("text-anchor", "end")
      .attr("x", width)
      .attr("y", height + 40)
      .text("Time (year)");

    // Add Y axis label:
    svg
      .append("text")
      .attr("text-anchor", "end")
      .attr("x", 0)
      .attr("y", -20)
      .text("Energy consumption split for the selected HDI range (TWh)")
      .attr("text-anchor", "start");

    // Add Y axis
    const y = d3
      .scaleLinear()
      .domain([
        0,
        d3.max(data, function (d) {
          return (
            +d.Hydropower +
            +d.Nuclear +
            +d.Solar +
            +d.Wind +
            +d.Coal +
            +d.Gas +
            +d.Oil +
            +d.Biofuel +
            +d.Other_renewables
          );
        }) * 1.1,
      ])
      .range([height, 0]);
    const yAxis = svg
      .append("g")
      .attr("transform", `translate(0, 0)`)
      .call(d3.axisLeft(y).ticks(5));

    //////////
    // BRUSHING AND CHART //
    //////////

    // Add a clipPath: everything out of this area won't be drawn.
    const clip = svg
      .append("defs")
      .append("svg:clipPath")
      .attr("id", "clip")
      .append("svg:rect")
      .attr("width", width)
      .attr("height", height)
      .attr("x", 0)
      .attr("y", 0);

    // Add brushing
    const brush = d3
      .brushY() // Add the brush feature using the d3.brush function
      .extent([
        [0, 0],
        [width, height],
      ]) // initialise the brush area: start at 0,0 and finishes at width,height: it means I select the whole graph area
      .on("end", updateChart); // Each time the brush selection changes, trigger the 'updateChart' function

    // Create the scatter variable: where both the circles and the brush take place
    const areaChart = svg.append("g").attr("clip-path", "url(#clip)");

    // Area generator
    const area = d3.area()
      .x(function (d) {
        return x(d.data.Year);
      })
      .y0(function (d) {
        return y(d[0]);
      })
      .y1(function (d) {
        return y(d[1]);
      });

    // Show the areas
    areaChart
      .selectAll("mylayers")
      .data(stackedData)
      .join("path")
      .attr("class", function (d) {
        return "myArea " + d.key;
      })
      .style("fill", function (d) {
        return color(d.key);
      })
      .attr("d", area);

    // Add the brushing
    areaChart.append("g").attr("class", "brush").call(brush);

    let idleTimeout;
    function idled() {
      idleTimeout = null;
    }

    // A function that update the chart for given boundaries
    function updateChart(event, d) {
      extent = event.selection;

      // If no selection, back to initial coordinate. Otherwise, update X axis domain
      if (!extent) {
        if (!idleTimeout) return (idleTimeout = setTimeout(idled, 350)); // This allows to wait a little bit
        y.domain(
          d3.extent(data, function (d) {
            return d.Year;
          })
        );
      } else {
        y.domain([y.invert(extent[1]), y.invert(extent[0])]);
        areaChart.select(".brush").call(brush.move, null); // This remove the grey brush area as soon as the selection has been done
      }

      // Update axis and area position
      yAxis.transition().duration(1000).call(d3.axisLeft(y).ticks(5));
      areaChart.selectAll("path").transition().duration(1000).attr("d", area);
    }

    // A function that update the chart
    function update(selectedGroup) {
      //stack the data?

      // get new data
      data = old_data.filter(function (d) {
        return d.HDI == selectedGroup;
      });

      const stackedData = d3.stack().keys(keys)(data);

      // set new y domain according to the new data
      y.domain([
        0,
        d3.max(data, function (d) {
          return (
            +d.Hydropower +
            +d.Nuclear +
            +d.Solar +
            +d.Wind +
            +d.Coal +
            +d.Gas +
            +d.Oil +
            +d.Biofuel +
            +d.Other_renewables
          );
        }),
      ]);

      // update y axis
      yAxis.transition().duration(1000).call(d3.axisLeft(y).ticks(5));
      // update areaChart

      console.log(data);
      areaChart.selectAll("path").remove();

      // Show the areas
      areaChart
        .selectAll("mylayers")
        .data(stackedData)
        .join("path")
        .transition()
        .duration(1000)
        .attr("class", function (d) {
          return "myArea " + d.key;
        })
        .style("fill", function (d) {
          return color(d.key);
        })
        .attr("d", area);
    }

    //////////
    // HIGHLIGHT GROUP //
    //////////

    // What to do when one group is hovered
    const highlight = function (event, d) {
      // reduce opacity of all groups
      d3.selectAll(".myArea").style("opacity", 0.1);
      // expect the one that is hovered
      d3.select("." + d).style("opacity", 1);
    };

    // And when it is not hovered anymore
    const noHighlight = function (event, d) {
      d3.selectAll(".myArea").style("opacity", 1);
    };

    //////////
    // LEGEND //
    //////////

    // Add one dot in the legend for each name.
    const size = 20;

    svg
      .selectAll("myrect")
      .data([
      "Other_renewables",
      "Wind",
      "Biofuel",
      "Solar",
      "Nuclear",
      "Hydropower",
      "Gas",
      "Oil",
      "Coal"
    ])
      .join("rect")
      .attr("x", width + 10)
      .attr("y", function (d, i) {
        return 10 + i * (size + 5);
      }) // 100 is where the first dot appears. 25 is the distance between dots
      .attr("width", size)
      .attr("height", size)
      .style("fill", function (d) {
        return color(d);
      })
      .on("mouseover", highlight)
      .on("mouseleave", noHighlight);

    // Add one dot in the legend for each name.


    svg
      .selectAll("mylabels")
      .data([
      "Other_renewables",
      "Wind",
      "Biofuel",
      "Solar",
      "Nuclear",
      "Hydropower",
      "Gas",
      "Oil",
      "Coal"
    ])
      .join("text")
      .attr("x", width + 10 + size * 1.2)
      .attr("y", function (d, i) {
        return 10 + i * (size + 5) + size / 2;
      }) // 100 is where the first dot appears. 25 is the distance between dots
      .style("fill", function (d) {
        return color(d);
      })
      .text(function (d) {
        return d;
      })
      .attr("text-anchor", "left")
      .style("alignment-baseline", "middle")
      .on("mouseover", highlight)
      .on("mouseleave", noHighlight);

    // When the button is changed, run the updateChart function
    d3.select("#HDI_category").on("change", function (event, d) {
      // recover the option that has been chosen
      const selectedOption = d3.select(this).property("value");
      // run the updateChart function with this selected option
      update(selectedOption);
    });
  });
</script>
<p><br></p>
<p>The stacked areas bring a fresh way of looking at evolution of the energy mix by HDI. We observe that <strong>the rate at which energy consumption is evolving is significantly higher for countries with medium and high HDI</strong>. Across all HDI categories, consumption of coal, oil and gas remains largely dominant. In the case of medium HDI countries, the staggering increase in energy consumption is almost solely supported by fossil energy sources. On the other hand, <strong>the evolution of the consumption of non-renewable energy seem to slow down in high HDI countries</strong>.</p>
<p>The solar energy seem to only be mastered by the wealthiest countries; probably because this specific mean of production might require a lot of prior investments. Interestingly, the potential of this energy source might in fact be higher in countries in central Africa, which benefit from a high level of solar exposition.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="results.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conclusion.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/AntoninVidon/energyhumandevelopment/edit/main/06-interactive.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/AntoninVidon/energyhumandevelopment/blob/main/06-interactive.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
